'use strict';

exports.__esModule = true;
exports.default = prerender;

var _path = require('path');

function prerender(outputDir, params) {
	params = params || {};

	var entry = (0, _path.resolve)(outputDir, './ssr-build/ssr-bundle.js'),
	    url = params.url || '/';

	global.location = { href: url, pathname: url };
	global.history = {};

	var m = require(entry),
	    app = m && m.default || m;

	if (typeof app !== 'function') {
		console.warn('Entry does not export a Component function/class, aborting prerendering.');
		return '';
	}

	var preact = require('preact'),
	    renderToString = require('preact-render-to-string');

	var html = renderToString(preact.h(app, { url }));

	return html;
}